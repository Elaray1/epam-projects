!function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function r(e){const t=e.toString(16);return 1===t.length?"0"+t:t}function n(e,t,o){return"#"+r(e)+r(t)+r(o)}o.r(t);const c=[["00BCD4","FFEB3B","FFEB3B","00BCD4"],["FFEB3B","FFC107","FFC107","FFEB3B"],["FFEB3B","FFC107","FFC107","FFEB3B"],["00BCD4","FFEB3B","FFEB3B","00BCD4"]],l=(e,t,o)=>{if(t<0||o<0||t>=e.width||o>=e.height)return NaN;const r=e.data,n=4*(o*e.width+t);return(255&r[n+0])<<24|(255&r[n+1])<<16|(255&r[n+2])<<8|(255&r[n+3])<<0},a=(e,t,o)=>{if(t<0||o<0||t>=e.width||o>=e.height)return NaN;const r=e.data,c=4*(o*e.width+t);return"0x"+n(r[c],r[c+1],r[c+2]).substr(1)+"FF"},d=(e,t,o,r)=>{const n=4*(o*e.width+t),c=e.data;c[n+0]=r>>>24&255,c[n+1]=r>>>16&255,c[n+2]=r>>>8&255,c[n+3]=r>>>0&255},u=(e,t)=>{if(isNaN(e)||isNaN(t))return 1/0;const o=(e>>>24&255)-(t>>>24&255),r=(e>>>16&255)-(t>>>16&255),n=(e>>>8&255)-(t>>>8&255),c=(e>>>0&255)-(t>>>0&255);return o*o+r*r+n*n+c*c};function s(e,t,o){"remove"===e?document.querySelector(o).classList.remove(t):"add"===e&&document.querySelector(o).classList.add(t)}window.onload=()=>{const e=localStorage.getItem("currentCanvas"),t=document.getElementById("canvas"),o=t.getContext("2d"),r=document.querySelector(".canvas-size"),i=document.querySelector(".pen-size");let g=t.width/r.value*i.value;const f="0xff0000FF",m=document.getElementById("red_color"),h=document.getElementById("blue_color"),y=document.getElementById("prev_color");if(null===e)!function(){for(let e=0;e<c.length;e++)for(let t=0;t<c[0].length;t++)o.fillStyle="#"+c[e][t],o.fillRect(t*g,e*g,g,g)}();else{const t=e,r=new Image;r.src=t,r.onload=function(){o.drawImage(r,0,0)}}const b=document.getElementById("pencil"),v=document.getElementById("choose_color"),p=document.getElementById("paint_bucket"),k=document.getElementById("eraser"),F=document.getElementById("straight_line");document.getElementById("change_all_pixels").addEventListener("click",()=>{o.fillStyle=`#${w.substr(2,w.length-4)}`,o.fillRect(0,0,t.width,t.height)});const S=[b,v,p,k,F];let E=b;E.classList.add("selected-tool"),S.forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".selected-tool").classList.remove("selected-tool"),e.classList.add("selected-tool"),E=e.getAttribute("id")})});let w=f;document.querySelector(".current-color").style.background="#FF0000";let B="0x808080FF";document.querySelector(".prev-color").style.background="#808080";const I=document.getElementById("select_color");I.addEventListener("input",(function(){document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=I.value,B=w,w="0x"+I.value.substr(1)+"FF"}),!1),m.addEventListener("click",()=>{B=w,w=f,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+w.substr(2,String(w).length-4)}),h.addEventListener("click",()=>{B=w,w="0x0000FFFF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+w.substr(2,String(w).length-4)}),y.addEventListener("click",()=>{let e=w;w=B,B=e,e=document.querySelector(".prev-color").style.background,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=e});let _=!1,q=!1,L=!1,D=0,x=0,M=o.getImageData(0,0,t.width,t.height);t.addEventListener("mousemove",e=>{switch([j,O]=[e.offsetX,e.offsetY],E){case"pencil":case b:!function(e,t,r){if(!_)return;const n=Math.floor(e/g)*g,c=Math.floor(t/g)*g,l=o.getImageData(n,c,g,g);for(let e=0;e<4*g*g;e+=4)l.data[e]=r>>>24&255,l.data[e+1]=r>>>16&255,l.data[e+2]=r>>>8&255,l.data[e+3]=r>>>0&255;o.putImageData(l,n,c)}(j,O,w);break;case"eraser":C(j,O);break;case"straight_line":N(j,O,D,x,M);break;default:return}}),t.addEventListener("mousedown",e=>{switch([j,O]=[e.offsetX,e.offsetY],E){case"pencil":case b:_=!0;break;case"eraser":q=!0;break;case"straight_line":L=!0,D=j,x=O,M=o.getImageData(0,0,t.width,t.height);break;default:return}});const C=(e,t)=>{q&&(o.fillStyle="rgba(255,255,255,1)",o.fillRect(Math.floor(e/g)*g,Math.floor(t/g)*g,g,g))},N=(e,r,n,c,l)=>{if(!L)return;o.putImageData(l,0,0),e=Math.floor(e/g)*g,r=Math.floor(r/g)*g,n=Math.floor(n/g)*g,c=Math.floor(c/g)*g;const a=Math.abs(e-n),d=Math.abs(r-c),u=n<e?1:-1,s=c<r?1:-1;let i=a-d;for(;n>=0&&n<t.width&&c>=0&&c<t.width&&(o.fillStyle=`#${w.substr(2,w.length-4)}`,o.fillRect(n,c,g,g),n!==e||c!==r);){const e=2*i;e>-d&&(i-=d,n+=u*g),e<a&&(i+=a,c+=s*g)}};t.addEventListener("mouseup",()=>{_=!1,q=!1,L=!1,M=o.getImageData(0,0,t.width,t.height)}),t.addEventListener("mouseout",()=>{_=!1,q=!1,L=!1,M=o.getImageData(0,0,t.width,t.height)});let j=0,O=0;t.addEventListener("click",e=>{j=e.layerX,O=e.layerY,"paint_bucket"===E?function(e,t,o,r,n){let c,s,i,g,f,m,h;const y=e.getContext("2d"),b=y.getImageData(0,0,e.width,e.height);if(a(b,t,o)===r)return;const v=[];for(let t=0;t<e.width;t++)v[t]=[];const p=l(b,t,o);for(n*=n,g=[[t,o]],v[t][o]=!0;c=g.pop();)if(m=c[0],h=c[1],u(l(b,m,h),p)<=n){for(d(b,m,h,r),s=i=m;s>0&&u(l(b,s-1,h),p)<=n&&(--s,!v[s][h]);)d(b,s,h,r);for(;i<b.width-1&&u(l(b,i+1,h),p)<=n&&(++i,!v[i][h]);)d(b,i,h,r);for(m=s;m<=i;m++)h>0&&(f=l(b,m,h-1),u(f,p)<=n&&(v[m][h-1]||(g.push([m,h-1]),v[m][h-1]=!0))),h<e.height-1&&(f=l(b,m,h+1),u(f,p)<=n&&(v[m][h+1]||(g.push([m,h+1]),v[m][h+1]=!0)))}y.putImageData(b,0,0,0,0,e.width,e.height)}(t,j,O,w,1):"choose_color"===E&&function(e,t){const r=o.getImageData(e,t,1,1).data;B=w,w="0x"+n(r[0],r[1],r[2]).substr(1)+"FF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=n(r[0],r[1],r[2])}(j,O)}),document.addEventListener("keydown",(function(e){switch(e.keyCode){case 66:E="paint_bucket",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#paint_bucket");break;case 80:E="pencil",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#pencil");break;case 67:E="choose_color",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#choose_color");break;case 69:E="eraser",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#eraser");break;case 83:E="straight_line",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#straight_line")}})),r.addEventListener("change",()=>{g=t.width/r.value*i.value}),i.addEventListener("change",()=>{g=t.width/r.value*i.value}),o.clearRect(0,0,t.width,t.height),window.addEventListener("beforeunload",()=>{localStorage.setItem("currentCanvas",t.toDataURL())})}}]);