!function(e){var t={};function o(r){if(t[r])return t[r].exports;var c=t[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,o),c.l=!0,c.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)o.d(r,c,function(t){return e[t]}.bind(null,c));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";function r(e){const t=e.toString(16);return 1===t.length?"0"+t:t}function c(e,t,o){return"#"+r(e)+r(t)+r(o)}o.r(t);const n=[["00BCD4","FFEB3B","FFEB3B","00BCD4"],["FFEB3B","FFC107","FFC107","FFEB3B"],["FFEB3B","FFC107","FFC107","FFEB3B"],["00BCD4","FFEB3B","FFEB3B","00BCD4"]],l=(e,t,o)=>{if(t<0||o<0||t>=e.width||o>=e.height)return NaN;const r=e.data,c=4*(o*e.width+t);return(255&r[c+0])<<24|(255&r[c+1])<<16|(255&r[c+2])<<8|(255&r[c+3])<<0},a=(e,t,o)=>{if(t<0||o<0||t>=e.width||o>=e.height)return NaN;const r=e.data,n=4*(o*e.width+t);return"0x"+c(r[n],r[n+1],r[n+2]).substr(1)+"FF"},d=(e,t,o,r)=>{const c=4*(o*e.width+t),n=e.data;n[c+0]=r>>>24&255,n[c+1]=r>>>16&255,n[c+2]=r>>>8&255,n[c+3]=r>>>0&255},u=(e,t)=>{if(isNaN(e)||isNaN(t))return 1/0;const o=(e>>>24&255)-(t>>>24&255),r=(e>>>16&255)-(t>>>16&255),c=(e>>>8&255)-(t>>>8&255),n=(e>>>0&255)-(t>>>0&255);return o*o+r*r+c*c+n*n};function s(e,t,o){"remove"===e?document.querySelector(o).classList.remove(t):"add"===e&&document.querySelector(o).classList.add(t)}window.onload=()=>{const e=localStorage.getItem("currentCanvas"),t=document.getElementById("canvas"),o=t.getContext("2d"),r=20,i="0xff0000FF",g=document.getElementById("red_color"),f=document.getElementById("blue_color"),m=document.getElementById("prev_color");if(null===e)!function(){for(let e=0;e<n.length;e++)for(let t=0;t<n[0].length;t++)o.fillStyle="#"+n[e][t],o.fillRect(t*r,e*r,r,r)}();else{const t=e,r=new Image;r.src=t,r.onload=function(){o.drawImage(r,0,0)}}const h=document.getElementById("pencil"),y=document.getElementById("choose_color"),b=document.getElementById("paint_bucket"),p=document.getElementById("eraser"),v=document.getElementById("straight_line"),F=[h,y,b,p,v];let k=h;k.classList.add("selected-tool"),F.forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".selected-tool").classList.remove("selected-tool"),e.classList.add("selected-tool"),k=e.getAttribute("id")})});let S=i;document.querySelector(".current-color").style.background="#FF0000";let E="0x808080FF";document.querySelector(".prev-color").style.background="#808080";const B=document.getElementById("select_color");B.addEventListener("input",(function(){document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=B.value,E=S,S="0x"+B.value.substr(1)+"FF"}),!1),g.addEventListener("click",()=>{E=S,S=i,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+S.substr(2,String(S).length-4)}),f.addEventListener("click",()=>{E=S,S="0x0000FFFF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+S.substr(2,String(S).length-4)}),m.addEventListener("click",()=>{let e=S;S=E,E=e,e=document.querySelector(".prev-color").style.background,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=e});let w=!1,I=!1,_=!1,q=0,L=0,D=o.getImageData(0,0,t.width,t.height);t.addEventListener("mousemove",e=>{switch([C,N]=[e.offsetX,e.offsetY],k){case"pencil":case h:!function(e,t,c){if(!w)return;const n=Math.floor(e/r)*r,l=Math.floor(t/r)*r,a=o.getImageData(n,l,r,r);for(let e=0;e<4*r*r;e+=4)a.data[e]=c>>>24&255,a.data[e+1]=c>>>16&255,a.data[e+2]=c>>>8&255,a.data[e+3]=c>>>0&255;o.putImageData(a,n,l)}(C,N,S);break;case"eraser":M(C,N);break;case"straight_line":x(C,N,q,L,D);break;default:return}}),t.addEventListener("mousedown",e=>{switch([C,N]=[e.offsetX,e.offsetY],k){case"pencil":case h:w=!0;break;case"eraser":I=!0;break;case"straight_line":_=!0,q=C,L=N,D=o.getImageData(0,0,t.width,t.height);break;default:return}});const M=(e,t)=>{I&&(o.fillStyle="rgba(255,255,255,1)",o.fillRect(Math.floor(e/r)*r,Math.floor(t/r)*r,r,r))},x=(e,c,n,l,a)=>{if(!_)return;o.putImageData(a,0,0),e=Math.floor(e/r)*r,c=Math.floor(c/r)*r,n=Math.floor(n/r)*r,l=Math.floor(l/r)*r;const d=Math.abs(e-n),u=Math.abs(c-l),s=n<e?1:-1,i=l<c?1:-1;let g=d-u;for(;n>=0&&n<t.width&&l>=0&&l<t.width&&(o.fillStyle=`#${S.substr(2,S.length-4)}`,o.fillRect(n,l,r,r),n!==e||l!==c);){const e=2*g;e>-u&&(g-=u,n+=s*r),e<d&&(g+=d,l+=i*r)}};t.addEventListener("mouseup",()=>{w=!1,I=!1,_=!1,D=o.getImageData(0,0,t.width,t.height)}),t.addEventListener("mouseout",()=>{w=!1,I=!1,_=!1,D=o.getImageData(0,0,t.width,t.height)});let C=0,N=0;t.addEventListener("click",e=>{C=e.layerX,N=e.layerY,"paint_bucket"===k?function(e,t,o,r,c){let n,s,i,g,f,m,h;const y=e.getContext("2d"),b=y.getImageData(0,0,e.width,e.height);if(a(b,t,o)===r)return;const p=[];for(let t=0;t<e.width;t++)p[t]=[];const v=l(b,t,o);for(c*=c,g=[[t,o]],p[t][o]=!0;n=g.pop();)if(m=n[0],h=n[1],u(l(b,m,h),v)<=c){for(d(b,m,h,r),s=i=m;s>0&&u(l(b,s-1,h),v)<=c&&(--s,!p[s][h]);)d(b,s,h,r);for(;i<b.width-1&&u(l(b,i+1,h),v)<=c&&(++i,!p[i][h]);)d(b,i,h,r);for(m=s;m<=i;m++)h>0&&(f=l(b,m,h-1),u(f,v)<=c&&(p[m][h-1]||(g.push([m,h-1]),p[m][h-1]=!0))),h<e.height-1&&(f=l(b,m,h+1),u(f,v)<=c&&(p[m][h+1]||(g.push([m,h+1]),p[m][h+1]=!0)))}y.putImageData(b,0,0,0,0,e.width,e.height)}(t,C,N,S,1):"choose_color"===k&&function(e,t){const r=o.getImageData(e,t,1,1).data;E=S,S="0x"+c(r[0],r[1],r[2]).substr(1)+"FF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=c(r[0],r[1],r[2])}(C,N)}),document.addEventListener("keydown",(function(e){switch(e.keyCode){case 66:k="paint_bucket",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#paint_bucket");break;case 80:k="pencil",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#pencil");break;case 67:k="choose_color",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#choose_color");break;case 69:k="eraser",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#eraser");break;case 83:k="straight_line",s("remove","selected-tool",".selected-tool"),s("add","selected-tool","#straight_line")}})),o.clearRect(0,0,t.width,t.height),window.addEventListener("beforeunload",()=>{localStorage.setItem("currentCanvas",t.toDataURL())})}}]);