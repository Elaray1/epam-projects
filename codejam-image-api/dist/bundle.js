!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);o(1)},function(e,t){function o(e){let t=e.toString(16);return 1==t.length?"0"+t:t}function n(e,t,n){return"#"+o(e)+o(t)+o(n)}window.onload=function(){let e=localStorage.getItem("currentCanvas");const t=document.getElementById("canvas"),o=t.getContext("2d");let r=4;const c=[["00BCD4","FFEB3B","FFEB3B","00BCD4"],["FFEB3B","FFC107","FFC107","FFEB3B"],["FFEB3B","FFC107","FFC107","FFEB3B"],["00BCD4","FFEB3B","FFEB3B","00BCD4"]];if(null==e)!function(){for(let e=0;e<c.length;e++)for(let t=0;t<c[0].length;t++)o.fillStyle="#"+c[e][t],o.fillRect(t*r,e*r,r,r)}();else{let t=e,n=new Image;n.src=t,n.onload=function(){o.drawImage(n,0,0)}}const l=document.getElementById("pencil"),d=document.getElementById("choose_color"),u=document.getElementById("paint_bucket");let a=l;function i(e,t,o){if(t<0||o<0||t>=e.width||o>=e.height)return NaN;let n=e.data,r=4*(o*e.width+t);return(255&n[r+0])<<24|(255&n[r+1])<<16|(255&n[r+2])<<8|(255&n[r+3])<<0}function s(e,t,o,n){let r=4*(o*e.width+t),c=e.data;c[r+0]=n>>>24&255,c[r+1]=n>>>16&255,c[r+2]=n>>>8&255,c[r+3]=n>>>0&255}function g(e,t){if(isNaN(e)||isNaN(t))return 1/0;let o=(e>>>24&255)-(t>>>24&255),n=(e>>>16&255)-(t>>>16&255),r=(e>>>8&255)-(t>>>8&255),c=(e>>>0&255)-(t>>>0&255);return o*o+n*n+r*r+c*c}a.classList.add("selected-tool"),[l,d,u].forEach(e=>{e.addEventListener("click",()=>{document.querySelector(".selected-tool").classList.remove("selected-tool"),e.classList.add("selected-tool"),a=e.getAttribute("id")})});const f="0xFF0000FF";let m=f;document.querySelector(".current-color").style.background="#FF0000";let h="0x808080FF";document.querySelector(".prev-color").style.background="#808080";let y=document.getElementById("select_color");y.addEventListener("input",(function(){document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=y.value,h=m,m="0x"+y.value.substr(1)+"FF"}),!1);const b=document.getElementById("red_color"),p=document.getElementById("blue_color"),v=document.getElementById("prev_color");function F(e,t,n){if(!E)return;e=Math.floor(e/r)*r,t=Math.floor(t/r)*r;let c=o.getImageData(e,t,r,r);for(let e=0;e<4*r*r;e+=4)c.data[e]=n>>>24&255,c.data[e+1]=n>>>16&255,c.data[e+2]=n>>>8&255,c.data[e+3]=n>>>0&255;o.putImageData(c,e,t)}b.addEventListener("click",()=>{h=m,m=f,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+m.substr(2,String(m).length-4)}),p.addEventListener("click",()=>{h=m,m="0x0000FFFF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background="#"+m.substr(2,String(m).length-4)}),v.addEventListener("click",()=>{let e=m;m=h,h=e,e=document.querySelector(".prev-color").style.background,document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=e});let E=!1;t.addEventListener("mousemove",e=>{"pencil"==a&&a==l||([S,k]=[e.offsetX,e.offsetY],F(S,k,m))}),t.addEventListener("mousedown",e=>{"pencil"!=a&&a!=l||(E=!0,[S,k]=[e.offsetX,e.offsetY],F(S,k,m))}),t.addEventListener("mouseup",()=>E=!1),t.addEventListener("mouseout",()=>E=!1);let S=0,k=0;t.addEventListener("click",e=>{S=e.layerX,k=e.layerY,"paint_bucket"==a?function(e,t,o,r,c){let l,d,u,a,f,h,y,b=e.getContext("2d"),p=b.getImageData(t,o,1,1).data;if("0x"+n(p[0],p[1],p[2]).substr(1)+"FF"===m)return;let v=b.getImageData(0,0,e.width,e.height),F=[];for(let t=0;t<e.width;t++)F[t]=[];let E=i(v,t,o);for(c*=c,a=[[t,o]],F[t][o]=!0;l=a.pop();)if(g(i(v,h=l[0],y=l[1]),E)<=c){for(s(v,h,y,r),d=u=h;d>0&&g(i(v,d-1,y),E)<=c&&!F[--d][y];)s(v,d,y,r);for(;u<v.width-1&&g(i(v,u+1,y),E)<=c&&!F[++u][y];)s(v,u,y,r);for(h=d;h<=u;h++)y>0&&g(f=i(v,h,y-1),E)<=c&&(F[h][y-1]||(a.push([h,y-1]),F[h][y-1]=!0)),y<e.height-1&&g(f=i(v,h,y+1),E)<=c&&(F[h][y+1]||(a.push([h,y+1]),F[h][y+1]=!0))}b.putImageData(v,0,0,0,0,e.width,e.height)}(t,S,k,m,1):"choose_color"==a&&function(e,t){let r=o.getImageData(e,t,1,1).data;h=m,m="0x"+n(r[0],r[1],r[2]).substr(1)+"FF",document.querySelector(".prev-color").style.background=document.querySelector(".current-color").style.background,document.querySelector(".current-color").style.background=n(r[0],r[1],r[2])}(S,k)}),document.addEventListener("keydown",(function(e){66==e.keyCode?(a="paint_bucket",document.querySelector(".selected-tool").classList.remove("selected-tool"),u.classList.add("selected-tool")):80==e.keyCode?(a="pencil",document.querySelector(".selected-tool").classList.remove("selected-tool"),l.classList.add("selected-tool")):67==e.keyCode&&(a="choose_color",document.querySelector(".selected-tool").classList.remove("selected-tool"),d.classList.add("selected-tool"))}));const w=512;$((function(){$("#slider-range-pencil").slider({range:"min",value:128,min:128,max:512,step:128,slide:function(e,t){$("#pencil-size").val((w/t.value).toFixed(1)),r=w/t.value}}),$("#pencil-size").val((w/$("#slider-range-pencil").slider("value")).toFixed(1))}));const B="ef8e0674f82bf16c9a2d6833fd2e0dbb57b72480187835b3b76daf3342640bfd";const I=document.getElementById("load-btn"),L=document.getElementById("black-and-white-btn");I.addEventListener("click",()=>{!async function(e){const n=`https://api.unsplash.com/photos/random?query=town,${e}&client_id=${B}`;let r=await fetch(n).then(e=>e.json()),c=new Image;c.onload=function(){const e=this.width,n=this.height;e>=n?(this.width=w,this.height=n*w/e):(this.height=w,this.width=e*w/n),o.fillStyle="rgb(192, 192, 192)",o.fillRect(0,0,t.width,t.height),e>=n?o.drawImage(c,0,(t.height-this.height)/2,this.width,this.height):o.drawImage(c,(t.width-this.width)/2,0,this.width,this.height)},c.src=r.urls.small,c.crossOrigin="Anonymous"}(document.getElementById("search-input").value)}),L.addEventListener("click",()=>{(()=>{const e=o.getImageData(0,0,t.width,t.height),n=e.data;for(let e=0;e<n.length;e+=4){let t=(n[e]+n[e+1]+n[e+2])/3;n[e]=t,n[e+1]=t,n[e+2]=t}o.putImageData(e,0,0)})()}),window.addEventListener("beforeunload",()=>{localStorage.setItem("currentCanvas",t.toDataURL())})},e.exports=n}]);